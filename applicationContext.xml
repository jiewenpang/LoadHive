<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
	xmlns:util="http://www.springframework.org/schema/util"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
	http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
	http://www.springframework.org/schema/util
	http://www.springframework.org/schema/util/spring-util-2.5.xsd">
	
	<!-- 
		共分为4种：property是公共节点，EL表达式解析节点，basevalue模板节点，其余是各业务节点
		1.property是程序本身的配置，例如日志路径等
		2.*EL是表达式解析节点，用于解析表达式，全大写的单词是需要业务处理类去替换的
		3.业务节点继承并可以覆盖basevalue的参数，需要指定自身业务的参数，业务节点的处理类必须指定正确，一般必须指定：
		  name是会作为线程名打印到日志，请保持不超过7字节
		  inputDir处理目录
		  outputDir输出目录
		  ...
	-->
	
	<bean id="property" class="com.asiainfo.inhive.Constant">
		<property name="propertyMap">
			<util:map map-class="java.util.HashMap">
				<entry key="LOG_PATH" value="./log" />
				<entry key="LOGBACK_CONF_FILE" value="./logback.xml" />
				<entry key="krb5conf" value="/home/bd_qzdzx/krb5.conf" />
				<entry key="keytab" value="/home/bd_qzdzx/user.keytab" />
				<entry key="jaasconf" value="/opt/client/HDFS/hadoop/etc/hadoop/jaas.conf" />
				<entry key="principal" value="bd_qzdzx@HADOOP.COM" />
				<!-- 
				开发集群：jdbc:hive2://172.16.1.228:10000/default
				联调集群：jdbc:hive2://172.32.0.3:24002,172.32.0.2:24002,172.32.0.1:24002/;serviceDiscoveryMode=zooKeeper;zooKeeperNamespace=hiveserver2;sasl.qop=auth-conf;auth=KERBEROS;principal=hive/hadoop.hadoop.com@HADOOP.COM
				生产集群：jdbc:hive2://192.252.102.89:24002,192.252.102.90:24002,192.252.102.139:24002/;serviceDiscoveryMode=zooKeeper;zooKeeperNamespace=hiveserver2_2;sasl.qop=auth-conf;auth=KERBEROS;principal=hive2/hadoop.hadoop.com@HADOOP.COM
				-->
				<entry key="connString" value="jdbc:hive2://172.16.1.228:10000/default" />
				<entry key="class" value="org.apache.hive.jdbc.HiveDriver" />
			</util:map>
		</property>
	</bean>

	<bean id="prefixMatchEL" class="com.asiainfo.elexplain.BaseEL">
		<property name="paramMap">
			<util:map map-class="java.util.HashMap">
				<entry key="$FILE" value="" />
				<entry key="$PREFIX" value="" />
			</util:map>
		</property>
		<property name="stringExpression" value="$FILE.startsWith($PREFIX)" />
		<property name="returnTypeExpression" value="java.lang.Boolean" />
	</bean>
	
	<bean id="substringEL" class="com.asiainfo.elexplain.BaseEL">
		<property name="paramMap">
			<util:map map-class="java.util.HashMap">
				<entry key="$FILE" value="" />
			</util:map>
		</property>
		<property name="stringExpression" value="$FILE.split('_')[3]" />
		<property name="returnTypeExpression" value="java.lang.String" />
	</bean>
	
	<bean id="replaceEL" class="com.asiainfo.elexplain.BaseEL">
		<property name="paramMap">
			<util:map map-class="java.util.HashMap">
				<entry key="$FILE" value="" />
				<entry key="$OLDSTR" value="" />
				<entry key="$NEWSTR" value="" />
			</util:map>
		</property>
		<property name="stringExpression" value="$FILE.replace($OLDSTR,$NEWSTR)" />
		<property name="returnTypeExpression" value="java.lang.String" />
	</bean>
	
	<bean id="pick" class="com.asiainfo.bo.Pick" >
		<property name="name"  value="pick" />
		<property name="tablePrefix"  value="cdr_" />
		<property name="createSqlMap">
			<util:map map-class="java.util.HashMap">
				<!-- 程序内会把$开头的大写字母组成的变量进行替换组装，此处涉及变量有 $TABLENAME和$OUTPUTDIR -->
				<entry key="cdr_01" value="CREATE EXTERNAL TABLE IF NOT EXISTS $TABLENAME(EventFormatType String,roll_flag String,roll_count String,file_id String,exc_id String,FileType String,subno String,IMSI String,IMEI String,start_time String,special_flag String,proc_time String,event_id String,Switch_flag String,District String,Brand String,User_Type String,Visit_Area String,B_subno String,Bill_type String,ACCT_Mob String,ACCT_Toll String,ACCT_Inf String,Mob_fee String,Toll_fee String,Inf_fee String,Pay_mode String,dis_id String,reserve String,cbe_flag String,period_flag String,SubsID String,A_pay_type String,A_pay_subno String,A_pay_switch_flag String,A_pay_district String,A_pay_brand String,A_pay_user_type String,A_AcctID String,A_deducted String,A_ACCT_BALANCE String,A_ACCT_BALANCE_ID1 String,A_ACCT_BALANCE_AMT1 String,A_ACCT_BALANCE_ID2 String,A_ACCT_BALANCE_AMT2 String,A_ACCT_BALANCE_ID3 String,A_ACCT_BALANCE_AMT3 String,A_ACCT_BALANCE_ID4 String,A_ACCT_BALANCE_AMT4 String,B_pay_type String,B_pay_subno String,B_pay_switch_flag String,B_pay_district String,B_pay_brand String,B_pay_user_type String,B_AcctID String,B_deducted String,B_ACCT_BALANCE String,B_ACCT_BALANCE_ID1 String,B_ACCT_BALANCE_AMT1 String,B_ACCT_BALANCE_ID2 String,B_ACCT_BALANCE_AMT2 String,B_ACCT_BALANCE_ID3 String,B_ACCT_BALANCE_AMT3 String,xd_type String,bus_code String,bus_type String,subbus_type String,rat_type String,dis_code String,direct_type String,visit_switch_flag String,roam_type String,toll_type String,carry_type String,b_operator String,b_switch_flag String,b_brand String,b_user_type String,dis_dura String,dis_fee String,Reserve2 String,Relation String,duration String,net_type String,multi_call String,call_type String,call_flag String,msisdnB String,msisdnC String,real_msisdn String,msrn String,msc_id String,calling_lac String,calling_cellid String,called_lac String,called_cellid String,out_router String,in_router String, service_type String,service_code String, session_id String,session_si String,session_type String,FCI String,vpn_call_type String,fee_one String, fee_two String,Reserve3 String) partitioned by (cityid string,dt string,dealdate string) ROW FORMAT delimited fields terminated by '|' STORED AS TEXTFILE LOCATION '$OUTPUTDIR/$TABLENAME'" />
				<entry key="cdr_02" value="CREATE EXTERNAL TABLE IF NOT EXISTS $TABLENAME(EventFormatType String,roll_flag String,roll_count String,file_id String,exc_id String,FileType String,subno String,IMSI String,IMEI String,start_time String,special_flag String,proc_time String,event_id String,Switch_flag String,District String,Brand String,User_Type String,Visit_Area String,B_subno String,Bill_type String,ACCT_Mob String,ACCT_Toll String,ACCT_Inf String,Mob_fee String,Toll_fee String,Inf_fee String,Pay_mode String,dis_id String,reserve String,cbe_flag String,period_flag String,SubsID String,A_pay_type String,A_pay_subno String,A_pay_switch_flag String,A_pay_district String,A_pay_brand String,A_pay_user_type String,A_AcctID String,A_deducted String,A_ACCT_BALANCE String,A_ACCT_BALANCE_ID1 String,A_ACCT_BALANCE_AMT1 String,A_ACCT_BALANCE_ID2 String,A_ACCT_BALANCE_AMT2 String,A_ACCT_BALANCE_ID3 String,A_ACCT_BALANCE_AMT3 String,A_ACCT_BALANCE_ID4 String,A_ACCT_BALANCE_AMT4 String,B_pay_type String,B_pay_subno String,B_pay_switch_flag String,B_pay_district String,B_pay_brand String,B_pay_user_type String,B_AcctID String,B_deducted String,B_ACCT_BALANCE String,B_ACCT_BALANCE_ID1 String,B_ACCT_BALANCE_AMT1 String,B_ACCT_BALANCE_ID2 String,B_ACCT_BALANCE_AMT2 String,B_ACCT_BALANCE_ID3 String,B_ACCT_BALANCE_AMT3 String,xd_type String,bus_code String,bus_type String,subbus_type String,rat_type String,dis_code String,direct_type String,visit_switch_flag String,roam_type String,b_operator String,b_switch_flag String,b_brand String,b_user_type String,icp_stat String,dis_dura String,dis_fee String,Reserve2 String,relation String,msisdnB String,real_msisdn String,cdr_tag String,srv_tag String,direct_tag String,vpmn_tag String,sp_code String,op_code String,cdr_fee String,chrg_type String,duration String,srv_type String,channel_id String,extend_one String,extend_two String,Reserve3 String) partitioned by (cityid string,dt string,dealdate string) ROW FORMAT delimited fields terminated by '|' STORED AS TEXTFILE LOCATION '$OUTPUTDIR/$TABLENAME'" />
				<entry key="cdr_03" value="CREATE EXTERNAL TABLE IF NOT EXISTS $TABLENAME(EventFormatType String,roll_flag String,roll_count String,file_id String,exc_id String,FileType String,subno String,IMSI String,IMEI String,start_time String,special_flag String,proc_time String,event_id String,Switch_flag String,District String,Brand String,User_Type String,Visit_Area String,B_subno String,Bill_type String,ACCT_Mob String,ACCT_Toll String,ACCT_Inf String,Mob_fee String,Toll_fee String,Inf_fee String,Pay_mode String,dis_id String,reserve String,cbe_flag String,period_flag String,SubsID String,A_pay_type String,A_pay_subno String,A_pay_switch_flag String,A_pay_district String,A_pay_brand String,A_pay_user_type String,A_AcctID String,A_deducted String,A_ACCT_BALANCE String,A_ACCT_BALANCE_ID1 String,A_ACCT_BALANCE_AMT1 String,A_ACCT_BALANCE_ID2 String,A_ACCT_BALANCE_AMT2 String,A_ACCT_BALANCE_ID3 String,A_ACCT_BALANCE_AMT3 String,A_ACCT_BALANCE_ID4 String,A_ACCT_BALANCE_AMT4 String,B_pay_type String,B_pay_subno String,B_pay_switch_flag String,B_pay_district String,B_pay_brand String,B_pay_user_type String,B_AcctID String,B_deducted String,B_ACCT_BALANCE String,B_ACCT_BALANCE_ID1 String,B_ACCT_BALANCE_AMT1 String,B_ACCT_BALANCE_ID2 String,B_ACCT_BALANCE_AMT2 String,B_ACCT_BALANCE_ID3 String,B_ACCT_BALANCE_AMT3 String,xd_type String,bus_code String,bus_type String,subbus_type String,rat_type String,dis_code String,visit_switch_flag String,roam_type String,b_operator String,dis_dura String,dis_fee String,Reserve2 String,apn_switch_flag String,rg_code String,dur_vol_flag String,apn_type String,top_flag_fee String,charging_id String,real_msisdn String,apn_name_ni String,ggsn_addr String,sgsn_addr String,duration String,sequence String,service_code String,up_volume String,down_volume String,u_fee String,net_type String,visit_area_code String,visited_carrier_cd String,partial_typeid String,Reserve3 String) partitioned by (cityid string,dt string,dealdate string) ROW FORMAT delimited fields terminated by '|' STORED AS TEXTFILE LOCATION '$OUTPUTDIR/$TABLENAME'" />
				<entry key="cdr_04" value="CREATE EXTERNAL TABLE IF NOT EXISTS $TABLENAME(EventFormatType String,roll_flag String,roll_count String,file_id String,exc_id String,FileType String,subno String,IMSI String,IMEI String,start_time String,special_flag String,proc_time String,event_id String,Switch_flag String,District String,Brand String,User_Type String,Visit_Area String,B_subno String,Bill_type String,ACCT_Mob String,ACCT_Toll String,ACCT_Inf String,Mob_fee String,Toll_fee String,Inf_fee String,Pay_mode String,dis_id String,reserve String,cbe_flag String,period_flag String,SubsID String,A_pay_type String,A_pay_subno String,A_pay_switch_flag String,A_pay_district String,A_pay_brand String,A_pay_user_type String,A_AcctID String,A_deducted String,A_ACCT_BALANCE String,A_ACCT_BALANCE_ID1 String,A_ACCT_BALANCE_AMT1 String,A_ACCT_BALANCE_ID2 String,A_ACCT_BALANCE_AMT2 String,A_ACCT_BALANCE_ID3 String,A_ACCT_BALANCE_AMT3 String,A_ACCT_BALANCE_ID4 String,A_ACCT_BALANCE_AMT4 String,B_pay_type String,B_pay_subno String,B_pay_switch_flag String,B_pay_district String,B_pay_brand String,B_pay_user_type String,B_AcctID String,B_deducted String,B_ACCT_BALANCE String,B_ACCT_BALANCE_ID1 String,B_ACCT_BALANCE_AMT1 String,B_ACCT_BALANCE_ID2 String,B_ACCT_BALANCE_AMT2 String,B_ACCT_BALANCE_ID3 String,B_ACCT_BALANCE_AMT3 String,xd_type String,bus_code String,bus_type String,subbus_type String,rat_type String,dis_code String,direct_type String,visit_switch_flag String,roam_type String,toll_type String,carry_type String,b_operator String,b_switch_flag String,b_brand String,b_user_type String,dis_dura String,dis_fee String,Reserve2 String,duration String,msisdnA String,msisdnB String,msisdnC String,real_msisdn String,cdr_type String,call_type String,service_code String,ServType String,plan_mode String,call_flag String,roam_area String,cdr_mob_fee String,cdr_toll_fee String,cdr_inf_fee String,Reserve3 String) partitioned by (cityid string,dt string,dealdate string) ROW FORMAT delimited fields terminated by '|' STORED AS TEXTFILE LOCATION '$OUTPUTDIR/$TABLENAME'" />
				<entry key="cdr_05" value="CREATE EXTERNAL TABLE IF NOT EXISTS $TABLENAME(EventFormatType String,roll_flag String,roll_count String,file_id String,exc_id String,FileType String,subno String,IMSI String,IMEI String,start_time String,special_flag String,proc_time String,event_id String,Switch_flag String,District String,Brand String,User_Type String,Visit_Area String,B_subno String,Bill_type String,ACCT_Mob String,ACCT_Toll String,ACCT_Inf String,Mob_fee String,Toll_fee String,Inf_fee String,Pay_mode String,dis_id String,reserve String,cbe_flag String,period_flag String,SubsID String,A_pay_type String,A_pay_subno String,A_pay_switch_flag String,A_pay_district String,A_pay_brand String,A_pay_user_type String,A_AcctID String,A_deducted String,A_ACCT_BALANCE String,A_ACCT_BALANCE_ID1 String,A_ACCT_BALANCE_AMT1 String,A_ACCT_BALANCE_ID2 String,A_ACCT_BALANCE_AMT2 String,A_ACCT_BALANCE_ID3 String,A_ACCT_BALANCE_AMT3 String,A_ACCT_BALANCE_ID4 String,A_ACCT_BALANCE_AMT4 String,B_pay_type String,B_pay_subno String,B_pay_switch_flag String,B_pay_district String,B_pay_brand String,B_pay_user_type String,B_AcctID String,B_deducted String,B_ACCT_BALANCE String,B_ACCT_BALANCE_ID1 String,B_ACCT_BALANCE_AMT1 String,B_ACCT_BALANCE_ID2 String,B_ACCT_BALANCE_AMT2 String,B_ACCT_BALANCE_ID3 String,B_ACCT_BALANCE_AMT3 String,xd_type String,bus_code String,bus_type String,subbus_type String,rat_type String,dis_code String,visit_switch_flag String,roam_type String,b_operator String,dis_dura String,dis_fee String,Reserve2 String,area_id String,dur_vol_flag String,top_flag_fee String,cdr_roam_type String,real_msisdn String,duration String,up_volume String,down_volume String,hotspot_id String,logic_port_no String,cause_close String,user_ip_type String,user_ip String,cooperator_no String,basic_fee String,Reserve3 String) partitioned by (cityid string,dt string,dealdate string) ROW FORMAT delimited fields terminated by '|' STORED AS TEXTFILE LOCATION '$OUTPUTDIR/$TABLENAME'" />
				<entry key="cdr_06" value="CREATE EXTERNAL TABLE IF NOT EXISTS $TABLENAME(EventFormatType string,roll_flag string,roll_count string,file_id string,exc_id string,subno string,proc_time string,Switch_flag string,Brand string,Bill_type string,acctid string,fee string,acct_balance_b string,Reserve string,xd_type string,Show_time string,Begin_day string,End_day string,prodid string,op_id string,Reserve2 string) partitioned by (cityid string,dt string,dealdate string) ROW FORMAT delimited fields terminated by '|' STORED AS TEXTFILE LOCATION '$OUTPUTDIR/$TABLENAME'" />
				<entry key="cdr_07" value="CREATE EXTERNAL TABLE IF NOT EXISTS $TABLENAME(EventFormatType string,roll_flag string,roll_count string,file_id string,exc_id string,subno string,proc_time string,Switch_flag string,Brand string,Bill_type string,acctid string,fee string,acct_balance_b string,Reserve string,xd_type string,bus_code string,Show_time string,Fee_type string,pay_subno string,pay_switch_flag string,pay_brand string,Dis_fee string,Special_user string,object string,Special_subno string,sp_code string,multi_call string,Reserve2 string ) partitioned by (cityid string,dt string,dealdate string) ROW FORMAT delimited fields terminated by '|' STORED AS TEXTFILE LOCATION '$OUTPUTDIR/$TABLENAME'" />
				<entry key="cdr_11" value="CREATE EXTERNAL TABLE IF NOT EXISTS $TABLENAME(EventFormatType string,roll_flag string,roll_count string,file_id string,exc_id string,FileType string,subno string,IMSI string,IMEI string,start_time string,group_flag_no string,special_flag string,proc_time string,event_id string,Switch_flag string,District string,Brand string,User_Type string,Visit_Area string,B_subno string,Bill_type string,ACCT_Mob string,ACCT_Toll string,ACCT_Inf string,Mob_fee string,Toll_fee string,Inf_fee string,Pay_mode string,dis_id string,reserve string,cbe_flag string,period_flag string,SubsID string ,A_pay_type string,A_pay_subno string,A_pay_switch_flag string,A_pay_district string,A_pay_brand string,A_pay_user_type string,A_AcctID string,A_deducted string,A_ACCT_BALANCE string,A_ACCT_BALANCE_ID1 string,A_ACCT_BALANCE_AMT1 string,A_ACCT_BALANCE_ID2 string,A_ACCT_BALANCE_AMT2 string,A_ACCT_BALANCE_ID3 string,A_ACCT_BALANCE_AMT3 string,A_ACCT_BALANCE_ID4 string,A_ACCT_BALANCE_AMT4 string,B_pay_type string,B_pay_subno string,B_pay_switch_flag string,B_pay_district string,B_pay_brand string,B_pay_user_type string,B_AcctID string,B_deducted string,B_ACCT_BALANCE string,B_ACCT_BALANCE_ID1 string,B_ACCT_BALANCE_AMT1 string,B_ACCT_BALANCE_ID2 string,B_ACCT_BALANCE_AMT2 string,B_ACCT_BALANCE_ID3 string,B_ACCT_BALANCE_AMT3 string,xd_type string,bus_code string,bus_type string,subbus_type string,rat_type string,dis_code string,direct_type string,visit_switch_flag string,roam_type string,toll_type string,carry_type string,b_operator string,b_switch_flag string,b_brand string,b_user_type string,dis_dura string,dis_fee string,Reserve2 string,relation string,duration string,net_type string,multi_call string,call_type string,call_flag string,msisdnB string,msisdnC string,real_msisdn string,msrn string,msc_id string,calling_lac string,calling_cellid string,called_lac string,called_cellid string,out_router string,in_router string,service_type string,service_code string,session_id string,session_si string,session_type string,FCI string,vpn_call_type string,fee_one string,fee_two string,Reserve3 string) partitioned by (cityid string,dt string,dealdate string) ROW FORMAT delimited fields terminated by '|' STORED AS TEXTFILE LOCATION '$OUTPUTDIR/$TABLENAME'" />
				<entry key="cdr_12" value="CREATE EXTERNAL TABLE IF NOT EXISTS $TABLENAME(EventFormatType string,roll_flag string,roll_count string,file_id string,exc_id string,FileType string,subno string,IMSI string,IMEI string,start_time string,group_flag_no string,special_flag string,proc_time string,event_id string,Switch_flag string,District string,Brand string,User_Type string,Visit_Area string,B_subno string,Bill_type string,ACCT_Mob string,ACCT_Toll string,ACCT_Inf string,Mob_fee string,Toll_fee string,Inf_fee string,Pay_mode string,dis_id string,reserve string,cbe_flag string,period_flag string,SubsID string ,A_pay_type string,A_pay_subno string,A_pay_switch_flag string,A_pay_district string,A_pay_brand string,A_pay_user_type string,A_AcctID string,A_deducted string,A_ACCT_BALANCE string,A_ACCT_BALANCE_ID1 string,A_ACCT_BALANCE_AMT1 string,A_ACCT_BALANCE_ID2 string,A_ACCT_BALANCE_AMT2 string,A_ACCT_BALANCE_ID3 string,A_ACCT_BALANCE_AMT3 string,A_ACCT_BALANCE_ID4 string,A_ACCT_BALANCE_AMT4 string,B_pay_type string,B_pay_subno string,B_pay_switch_flag string,B_pay_district string,B_pay_brand string,B_pay_user_type string,B_AcctID string,B_deducted string,B_ACCT_BALANCE string,B_ACCT_BALANCE_ID1 string,B_ACCT_BALANCE_AMT1 string,B_ACCT_BALANCE_ID2 string,B_ACCT_BALANCE_AMT2 string,B_ACCT_BALANCE_ID3 string,B_ACCT_BALANCE_AMT3 string,xd_type string,bus_code string,bus_type string,subbus_type string,rat_type string,dis_code string,direct_type string,visit_switch_flag string,roam_type string,b_operator string,b_switch_flag string,b_brand string,b_user_type string,icp_stat string,dis_dura string,dis_fee string,Reserve2 string,relation string,msisdnB string,real_msisdn string,cdr_tag string,srv_tag string,direct_tag string,vpmn_tag string,sp_code string,op_code string,cdr_fee string,chrg_type string,duration string,srv_type string,channel_id string,extend_one string,extend_two string,Reserve3 string) partitioned by (cityid string,dt string,dealdate string) ROW FORMAT delimited fields terminated by '|' STORED AS TEXTFILE LOCATION '$OUTPUTDIR/$TABLENAME'" />
				<entry key="cdr_13" value="CREATE EXTERNAL TABLE IF NOT EXISTS $TABLENAME(EventFormatType string,roll_flag string,roll_count string,file_id string,exc_id string,FileType string,subno string,IMSI string,IMEI string,start_time string,group_flag_no string,special_flag string,proc_time string,event_id string,Switch_flag string,District string,Brand string,User_Type string,Visit_Area string,B_subno string,Bill_type string,ACCT_Mob string,ACCT_Toll string,ACCT_Inf string,Mob_fee string,Toll_fee string,Inf_fee string,Pay_mode string,dis_id string,reserve string,cbe_flag string,period_flag string,SubsID string ,A_pay_type string,A_pay_subno string,A_pay_switch_flag string,A_pay_district string,A_pay_brand string,A_pay_user_type string,A_AcctID string,A_deducted string,A_ACCT_BALANCE string,A_ACCT_BALANCE_ID1 string,A_ACCT_BALANCE_AMT1 string,A_ACCT_BALANCE_ID2 string,A_ACCT_BALANCE_AMT2 string,A_ACCT_BALANCE_ID3 string,A_ACCT_BALANCE_AMT3 string,A_ACCT_BALANCE_ID4 string,A_ACCT_BALANCE_AMT4 string,B_pay_type string,B_pay_subno string,B_pay_switch_flag string,B_pay_district string,B_pay_brand string,B_pay_user_type string,B_AcctID string,B_deducted string,B_ACCT_BALANCE string,B_ACCT_BALANCE_ID1 string,B_ACCT_BALANCE_AMT1 string,B_ACCT_BALANCE_ID2 string,B_ACCT_BALANCE_AMT2 string,B_ACCT_BALANCE_ID3 string,B_ACCT_BALANCE_AMT3 string,xd_type string,bus_code string,bus_type string,subbus_type string,rat_type string,dis_code string,visit_switch_flag string,roam_type string,b_operator string,dis_dura string,dis_fee string,Reserve2 string,b_switch_flag string,rg_code string,dur_vol_flag string,b_user_type string,b_brand string,top_flag_fee string,charging_id string,real_msisdn string,apn_name_ni string,ggsn_addr string,sgsn_addr string,duration string,sequence string,service_code string,up_volume string,down_volume string,u_fee string,net_type string,visit_area_code string,visited_carrier_cd string,partial_typeid string,Reserve3 string) partitioned by (cityid string,dt string,dealdate string) ROW FORMAT delimited fields terminated by '|' STORED AS TEXTFILE LOCATION '$OUTPUTDIR/$TABLENAME'" />
				<entry key="cdr_15" value="CREATE EXTERNAL TABLE IF NOT EXISTS $TABLENAME(EventFormatType string,roll_flag string,roll_count string,file_id string,exc_id string,FileType string,subno string,IMSI string,IMEI string,start_time string,group_flag_no string,special_flag string,proc_time string,event_id string,Switch_flag string,District string,Brand string,User_Type string,Visit_Area string,B_subno string,Bill_type string,ACCT_Mob string,ACCT_Toll string,ACCT_Inf string,Mob_fee string,Toll_fee string,Inf_fee string,Pay_mode string,dis_id string,reserve string,cbe_flag string,period_flag string,SubsID string ,A_pay_type string,A_pay_subno string,A_pay_switch_flag string,A_pay_district string,A_pay_brand string,A_pay_user_type string,A_AcctID string,A_deducted string,A_ACCT_BALANCE string,A_ACCT_BALANCE_ID1 string,A_ACCT_BALANCE_AMT1 string,A_ACCT_BALANCE_ID2 string,A_ACCT_BALANCE_AMT2 string,A_ACCT_BALANCE_ID3 string,A_ACCT_BALANCE_AMT3 string,A_ACCT_BALANCE_ID4 string,A_ACCT_BALANCE_AMT4 string,B_pay_type string,B_pay_subno string,B_pay_switch_flag string,B_pay_district string,B_pay_brand string,B_pay_user_type string,B_AcctID string,B_deducted string,B_ACCT_BALANCE string,B_ACCT_BALANCE_ID1 string,B_ACCT_BALANCE_AMT1 string,B_ACCT_BALANCE_ID2 string,B_ACCT_BALANCE_AMT2 string,B_ACCT_BALANCE_ID3 string,B_ACCT_BALANCE_AMT3 string,xd_type string,bus_code string,bus_type string,subbus_type string,rat_type string,dis_code string,visit_switch_flag string,roam_type string,b_operator string,dis_dura string,dis_fee string,Reserve2 string,area_id string,dur_vol_flag string,top_flag_fee string,cdr_roam_type string,real_msisdn string,duration string,up_volume string,down_volume string,hotspot_id string,logic_port_no string,cause_close string,user_ip_type string,user_ip string,cooperator_no string,basic_fee string,Reserve3 string)  partitioned by (cityid string,dt string,dealdate string) ROW FORMAT delimited fields terminated by '|' STORED AS TEXTFILE LOCATION '$OUTPUTDIR/$TABLENAME'" />
			</util:map>
		</property>
		<property name="loadSql"  value="load data inpath '$OUTPUTTMPDIR/$FILENAME' into table $TABLENAME partition(cityid='$CITYID',dt='$DAY',dealdate='$DEALDATE')" />
		<property name="chkDupDir"  value="./data/chkDupDir" />
		<property name="inputDirs"  value="./data/inputDirs" />
		<property name="inputFileNamePrefix"  value="cdr_" />
		<property name="inputDsuDir"  value="./data/inputDsuDir" />
		<property name="inputBakDir"  value="./data/inputBakDir" />
		<property name="outputTmpDir"  value="/tmp" />
		<property name="outputDir"  value="/pjw" />
		<property name="outputBakDir"  value="" />
		<property name="dailyCutTime"  value="020000" />	<!-- 用于生成处理日，单位是时分秒，如果不指定，则为非日切，否则按照指定时间日切生成 -->
		<property name="fixedDealDay"  value="32" />		<!-- 用于生成处理日，单位是日，非日切专用，如果不指定，则取计费日，否则取指定日期 -->
		<property name="partitionMap">
			<util:map map-class="java.util.HashMap">
				<entry key="dt" value="1021,1025" />
				<entry key="dealdate" value="1021,1025" />
			</util:map>
		</property>
	</bean>
	
	<bean id="migu" class="com.asiainfo.bo.Migu"  >
		<property name="name"  value="migu" />
	</bean>
	
	<bean id="jspick" class="com.asiainfo.bo.JsPick" >
		<property name="name"  value="jspick" />
	</bean>
	
</beans>